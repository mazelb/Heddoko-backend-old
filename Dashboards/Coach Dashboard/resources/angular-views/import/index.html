
<!-- Copyright Heddoko(TM) 2015, all rights reserved. -->

<div class="page import-page">
    <header>
        <h1>
            Upload <i class="fa fa-cloud-upload"></i>
            <span></span>
        </h1>

        <!-- Append profile name to page title -->
        <div ng-show="global.getSelectedProfile().id > 0" class="h1-append">
            for
            <a ng-click="global.store.profileId = 0" href="javascript:;">
                {{ global.getSelectedProfile().firstName }}
                {{ global.getSelectedProfile().lastName }}
                <i class="fa fa-refresh"></i>
            </a>
        </div>
    </header>

    <!-- Import page -->
    <div ng-show="global.getSelectedProfile().id > 0">
        <div class="movement-import row">

            <!-- Import new movement -->
            <div ng-show="global.data.isImporting === false" class="col-xs-12 text-center">
                <button
                    ngf-select="startImport($files)"
                    ngf-drop="startImport($files)"
                    accept=".csv,.txt"
                    ngf-max-size="2MB"
                    multiple
                    class="btn btn-primary btn-circle btn-lg">

                    <i class="fa fa-plus"></i>
                </button>
            </div>

            <!-- Uploading movement file -->
            <div ng-show="global.data.isImporting === true">

                <!-- Import status -->
                <br>
                <br>
                <h3 class="text-center">
                    {{ global.data.import.status }}

                    <br>
                    <small ng-show="global.data.import.queue.length > 1">
                        {{ global.data.import.queue.length }} movement files left.
                    </small>
                    <small ng-show="global.data.import.queue.length <= 1">
                        Almost done...
                    </small>
                </h3>
                <br>

                <!-- Import progress -->
                <div class="col-xs-10 col-xs-offset-1 col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4">
                    <div class="progress">
                        <div
                            class="progress-bar progress-bar-info progress-bar-striped active"
                            role="progressbar"
                            aria-valuenow="{{ global.data.import.progress }}"
                            aria-valuemin="0"
                            aria-valuemax="100"
                            style="min-width: 2em;"
                            ng-style="{width: global.data.import.progress + '%'}">

                            {{ global.data.import.progress }}%
                        </div>
                    </div>
                </div>

                <!-- Import actions -->
                <br>
                <div class="col-xs-12 text-center">
                    <div class="btn-group">
                        <button
                            ng-disabled="global.data.import.imported.length === 0"
                            ng-click="global.data.import.imported = []"
                            type="button"
                            class="btn btn-default">

                            Clear List
                        </button>

                        <button
                            ng-disabled="global.data.import.queue.length <= 1"
                            ng-click="global.data.import.queue = []"
                            type="button"
                            class="btn btn-danger">

                            Stop Import
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div ng-show="global.data.import.imported.length > 0">
            <!-- List of uploaded movements -->
            <div ng-repeat="file in global.data.import.imported" class="movement-import row">
                <div class="col-md-3 col-md-offset-1">

                    <!-- Movement title -->
                    <input
                        ng-model="file.title"
                        type="text"
                        class="form-control movement-title"
                        placeholder="Movement Title">

                    <!-- Tags -->
                    <ui-taggable-input
                        data-model="file"
                        data-key="tags"
                        data-max-tags="20">
                    </ui-taggable-input>
                </div>

                <div class="col-md-3">

                    <!-- Movement preview -->
                    <div class="row">
                        <div class="col-xs-12">
                            <ui-movement-preview data-aspect-ratio="4:3"></ui-movement-preview>
                        </div>
                    </div>

                    <!-- Delete movement -->
                    <div class="row">
                        <div class="col-xs-12">
                            <a ng-click="deleteMovement(file.id)" href="javascript:;" class="pull-right">
                                Delete Movement <i class="fa fa-trash-o"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Edit movement -->
                <div class="col-md-4">
                    <div class="movement-edit row">

                        <!-- Thumbnail link -->
                        <div class="col-md-5 text-right">
                            <a ng-click="selectThumbnail()" href="javascript:;">
                                Choose Thumbnail <i class="fa fa-picture-o"></i>
                            </a>
                        </div>

                        <div class="col-md-1 text-center">
                            <i class="fa fa-angle-double-right"></i>
                        </div>

                        <!-- Video edit link -->
                        <div class="col-md-5 text-left">
                            <a ng-click="editMovement()" href="javascript:;">
                                Edit Video <i class="fa fa-pencil"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Clear button -->
            <div class="movement-import row">
                <div class="col-sm-12 text-center">
                    <button
                        ng-click="global.data.import.imported = []"
                        type="button"
                        class="btn btn-default">

                        Clear List
                    </button>
                </div>
            </div>
        </div>

        <!-- No recently uploaded movement -->
        <div
            ng-show="global.data.import.imported.length === 0 && global.data.isImporting === false"
            class="col-md-6 col-md-offset-3 text-center">

            <h3>There are no movements to display.</h3>
            Once you upload or capture a new movement, it will show up here.
            <br><br>

            <b>Go ahead and use the <i class="fa fa-plus fa-lg fa-fw"></i> button above to start.</b>
        </div>
    </div>

    <!-- No profile selected -->
    <!-- <div ng-show="global.getSelectedProfile().id === 0">
        <div ng-include="'partials/select-profile.html'"></div>
    </div> -->
    <div ng-show="global.getSelectedProfile().id === 0">
        <h3 class="text-center">Select a profile to get started</h3>
        <br>

        <div class="col-md-4 col-md-offset-4 text-center">
            <ui-profile-lookup
                profiles="global.state.profile.list"
                select-profile="global.selectProfile(profile)">
            </ui-profile-lookup>
            <br>

            You can also take this opportunity to
            <a href="#/profile/create">create one</a>.
        </div>
    </div>
</div>
